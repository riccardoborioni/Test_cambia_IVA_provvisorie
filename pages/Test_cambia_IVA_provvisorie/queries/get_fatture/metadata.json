{
  "gitSyncId": "6601851cbf3e805bd6a4b13a_0bf287a6-334b-4adb-84aa-c13c7c344622",
  "id": "Test_cambia_IVA_provvisorie_get_fatture",
  "pluginId": "mssql-plugin",
  "pluginType": "DB",
  "unpublishedAction": {
    "actionConfiguration": {
      "body": "SELECT TOP 100\n    I.INMYCOMPANYID,\n    I.ININVOICEID,\n    I.INPURPOSEID,\n    I.INDOCUMENTTYPE,\n    I.INCUSTOMERDESCRIPTION,\n    I.INTAXYEAR,\n    I.ININVOICENUMBER,\n    I.ININVOICEDATE,\n    MAX(D.INHOSPITALIZATIONID) as INHOSPITALIZATIONID,\n    MAX(H.HOLASTNAME) as HOLASTNAME,\n    MAX(H.HOHOSPCOUNTER) as HOHOSPCOUNTER, \n    MAX(P.DPPURPOSEDESCRIPTION) as DPPURPOSEDESCRIPTION\n\nFROM ba_invoice_m I\nLEFT JOIN ba_document_purpose P ON I.INPURPOSEID = P.DPPURPOSEID\nLEFT JOIN ba_invoice D ON I.ININVOICEID = D.ININVOICEID\nLEFT JOIN ba_hospitalization H ON D.INHOSPITALIZATIONID = H.HOHOSPID\n\nWHERE I.INDOCUMENTTYPE IN ('FA', 'NC')\n  AND (I.ININVOICESET IS NULL OR I.ININVOICESET = '')\n  AND I.INSTATE = 'P'\n\n  -- *** LOGICA DI RICERCA ***\n  AND (\n       -- 1. Cerca per CF\n       (\n           '{{Input_CF.text}}' != ''\n           AND I.INCUFISCALCODE = '{{Input_CF.text}}' \n           AND ('{{Input_Anno.text}}' = '' OR I.INTAXYEAR = '{{Input_Anno.text}}')\n       )\n       OR \n       \n       -- 2. Cerca per Cartella\n       (\n           '{{Input_Cartella.text}}' != ''\n           AND H.HOHOSPCOUNTER = '{{Input_Cartella.text}}' \n           AND H.HOHOSPYEAR = '{{Input_Anno.text}}'\n       )\n       OR\n\n       -- 3. Cerca per NUMERO FATTURA (Quello che hai corretto tu!)\n       (\n           '{{Input_NumeroFattura.text}}' != ''\n           \n           -- RTRIM è il trucco: taglia gli spazi vuoti finali del database\n           AND RTRIM(I.ININVOICENUMBER) = '{{Input_NumeroFattura.text}}'\n           \n           -- Controllo Anno (importante: se l'input anno è vuoto, cerca in tutti gli anni)\n           AND (\n                 '{{Input_Anno.text}}' = '' \n                 OR I.INTAXYEAR = '{{Input_Anno.text}}'\n               )\n       )\n  )\n\nGROUP BY \n    I.INMYCOMPANYID,\n    I.ININVOICEID,\n    I.INPURPOSEID,\n    I.INDOCUMENTTYPE,\n    I.INCUSTOMERDESCRIPTION,\n    I.INTAXYEAR,\n    I.ININVOICENUMBER,\n    I.ININVOICEDATE\n\nORDER BY I.ININVOICEDATE DESC;",
      "encodeParamsToggle": true,
      "paginationType": "NONE",
      "pluginSpecifiedTemplates": [
        {
          "value": true
        }
      ],
      "timeoutInMillisecond": 10000
    },
    "confirmBeforeExecute": false,
    "datasource": {
      "id": "TEST_PAIDEIA",
      "isAutoGenerated": false,
      "name": "TEST_PAIDEIA",
      "pluginId": "mssql-plugin"
    },
    "dynamicBindingPathList": [
      {
        "key": "body"
      }
    ],
    "name": "get_fatture",
    "pageId": "Test_cambia_IVA_provvisorie",
    "runBehaviour": "AUTOMATIC",
    "userSetOnLoad": false
  }
}